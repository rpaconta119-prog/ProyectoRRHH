<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Personal - Recursos Humanos</title>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="topbar">
    <div class="topbar-left">
      <img src="Assets/LOGO.png" alt="Logo" class="logo-img" onerror="this.style.display='none'"/>
      <h1><i class="fa-solid fa-users-gear"></i> Personal</h1>
    </div>
    <div class="topbar-right">
      <a class="btn" href="index.html">
        <i class="fa-solid fa-arrow-left"></i> Volver
      </a>
      <button id="btn-logout" class="btn" title="Cerrar sesión">
        <i class="fa-solid fa-right-from-bracket"></i> Salir
      </button>
    </div>
  </header>

  <main class="content" style="padding:18px;">
    <section class="panel-grid">
      
      <div class="panel form-panel">
        <h2><i class="fa-solid fa-user-pen"></i> Gestión de Personal</h2>
        
        <form id="personForm">
          <input type="hidden" id="personId">
          
          <h4 style="margin-top:15px; border-bottom:1px solid #eee; padding-bottom:5px;">
            <i class="fa-regular fa-id-card" style="color:#4299e1; margin-right:5px;"></i> 
            1. Datos Personales
          </h4>
          
          <label>Nombre completo <input id="fullName" required/></label>
          <label>CUIL/CUIT <input id="cuil" placeholder="XX-XXXXXXXX-X" /></label>
          
          <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
             <label>Nacimiento <input id="birthDate" type="date" /></label>
             <label>Estado civil 
                <select id="maritalStatus">
                  <option value="">Seleccione</option>
                  <option>Soltero/a</option><option>Casado/a</option><option>Concubinato</option><option>Otro</option>
                </select>
             </label>
          </div>
          
          <label>Domicilio real <input id="address" /></label>
          <label>Contacto de emergencia <input id="emergencyContact" /></label>
          
          <h4 style="margin-top:15px; border-bottom:1px solid #eee; padding-bottom:5px;">
            <i class="fa-solid fa-briefcase" style="color:#48bb78; margin-right:5px;"></i> 
            2. Datos Laborales
          </h4>
          
          <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
             <label>Legajo <input id="legajo" /></label>
             <label>Categoría <input id="categoria" /></label>
          </div>
          
          <label>Rol <input id="rol" /></label>
          <label>Área <input id="area" /></label>
          <label>Coordinador <input id="coordinador" /></label>
          <label>Dir. oficina <input id="direccionOficina" /></label>  
          <input type="hidden" id="personJerId"> 
          <input type="hidden" id="parent">

          <h4 style="margin-top:15px; border-bottom:1px solid #eee; padding-bottom:5px;">
            <i class="fa-solid fa-people-roof" style="color:#ed8936; margin-right:5px;"></i> 
            3. Grupo Familiar
          </h4>
          <label>Cónyuge <input id="spouseInfo" /></label>
          <label>Hijos <textarea id="childrenInfo" rows="2"></textarea></label>

          <h4 style="margin-top:15px; border-bottom:1px solid #eee; padding-bottom:5px;">
             <i class="fa-solid fa-building-user" style="color:#805ad5; margin-right:5px;"></i> 
             4. Asignación
          </h4>
          <label>Sector <select id="personSector" required><option value="">Seleccione...</option></select></label>
          
          <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
            <label>Ingreso <input id="dateIn" type="date" /></label>
            <label>Baja <input id="dateOut" type="date" /></label>
          </div>

          <h4 style="margin-top:15px; border-bottom:1px solid #eee; padding-bottom:5px;">
             <i class="fa-solid fa-money-check-dollar" style="color:#38b2ac; margin-right:5px;"></i> 
             5. Haberes
          </h4>
          <label>CBU <input id="cbu" /></label>
          <label>Obra social <input id="obraSocial" /></label>
          <label>Observaciones <textarea id="taxInfo" rows="1"></textarea></label>

          <label><i class="fa-solid fa-camera"></i> Foto <input id="photoInput" type="file" accept="image/*" /></label>

          <div class="form-actions" style="margin-top:20px;">
            <button type="submit" class="btn primary">
                <i class="fa-solid fa-floppy-disk"></i> Guardar
            </button>
            <button type="button" id="btnReset" class="btn">
                <i class="fa-solid fa-plus"></i> Nuevo
            </button>
          </div>
        </form>
      </div>

      <div class="panel list-panel">
        <h2><i class="fa-solid fa-list-ul"></i> Listado de Personal</h2>
        
        <div class="search-row">
          <div style="position:relative; flex:1;">
             <i class="fa-solid fa-magnifying-glass" style="position:absolute; left:10px; top:50%; transform:translateY(-50%); color:#aaa;"></i>
             <input id="searchInput" placeholder="Buscar por nombre..." style="padding-left:30px; width:100%; box-sizing:border-box;" />
          </div>
          
          <select id="filterSector"><option value="">Todos los sectores</option></select>
          
          <button id="btnClear" class="btn" title="Limpiar filtros">
            <i class="fa-solid fa-filter-circle-xmark"></i>
          </button>
        </div>
        
        <div id="peopleContainer" class="people-container" style="margin-top:12px; max-height: 700px; overflow-y: auto; padding-right:5px;">
            </div> 
      </div>
    </section>
  </main>

  <div id="detailModal" class="modal hidden">
  <div class="modal-content">
    <button class="modal-close" id="modalClose">
      <i class="fa-solid fa-xmark"></i>
    </button>
    
    <div class="detail-header">
      <div class="detail-avatar" id="detailAvatar">
          <i class="fa-solid fa-user"></i> 
      </div>
      <div>
        <h3 id="detailName" style="margin:0; font-size:1.5rem; color:#2d3748;">Nombre del Empleado</h3>
        <div id="detailSector" class="muted" style="margin-top:5px;">
            <i class="fa-solid fa-building"></i> Sector
        </div>
      </div>
    </div>
    
    <div class="detail-body">
      <h4 style="color:#4a5568; margin-bottom:10px; display:flex; align-items:center;">
        <i class="fa-solid fa-address-card" style="margin-right:8px; color:#4299e1;"></i> 
        Datos personales
      </h4>
      <div id="detailPersonal" class="notes-box" style="margin-bottom:20px;"></div>
      
      <h4 style="color:#4a5568; margin-bottom:10px; display:flex; align-items:center;">
        <i class="fa-solid fa-people-roof" style="margin-right:8px; color:#ed8936;"></i> 
        Grupo familiar
      </h4>
      <div id="detailFamily" class="notes-box" style="margin-bottom:20px;"></div>
      
      <h4 style="color:#4a5568; margin-bottom:10px; display:flex; align-items:center;">
        <i class="fa-solid fa-file-contract" style="margin-right:8px; color:#48bb78;"></i> 
        Datos laborales / pago
      </h4>
      <div id="detailDocs" class="notes-box"></div>
    </div>
    
    <div class="modal-actions">
      <button id="editFromModal" class="btn">
          <i class="fa-solid fa-pen-to-square"></i> Editar
      </button>
      <button id="deleteFromModal" class="btn danger">
          <i class="fa-solid fa-trash-can"></i> Eliminar
      </button>
      <button id="closeModalBottom" class="btn">
          Cerrar
      </button>
    </div>
  </div>
</div>

  <script src="Script/api.js"></script>
  <script src="Script/backlog.js"></script>
  <script src="Script/sectors.js"></script>
  <script src="Script/people.js"></script>
  <script src="Script/auth.js"></script>
</body>
</html>